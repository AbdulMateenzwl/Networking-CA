<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/145.0.0.0 Safari/537.36" version="29.5.2">
  <diagram name="CI/CD Pipeline Flow" id="cicd-part4">
    <mxGraphModel dx="718" dy="407" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1920" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="title" parent="1" style="text;html=1;strokeColor=#001DBC;fillColor=#0050ef;align=center;verticalAlign=middle;whiteSpace=wrap;fontSize=20;fontStyle=1;fontColor=#ffffff;rounded=1;" value="CI/CD Pipeline with GitHub Actions (Part 4)" vertex="1">
          <mxGeometry height="40" width="870" x="100" y="10" as="geometry" />
        </mxCell>
        <mxCell id="dev-bg" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;arcSize=10;" value="" vertex="1">
          <mxGeometry height="210" width="220" x="40" y="80" as="geometry" />
        </mxCell>
        <mxCell id="dev-title" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontStyle=1;fontSize=14;" value="ðŸ’» Developer" vertex="1">
          <mxGeometry height="28" width="220" x="40" y="88" as="geometry" />
        </mxCell>
        <mxCell id="dev-edit" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#6c8ebf;fontSize=11;" value="1. Edit index.html or any file" vertex="1">
          <mxGeometry height="30" width="180" x="60" y="125" as="geometry" />
        </mxCell>
        <mxCell id="dev-add" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#6c8ebf;fontSize=11;" value="2. git add ." vertex="1">
          <mxGeometry height="30" width="180" x="60" y="165" as="geometry" />
        </mxCell>
        <mxCell id="dev-commit" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#6c8ebf;fontSize=11;" value="3. git commit -m &quot;update&quot;" vertex="1">
          <mxGeometry height="30" width="180" x="60" y="205" as="geometry" />
        </mxCell>
        <mxCell id="dev-push" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#1A202C;strokeColor=#1A202C;fontSize=11;fontStyle=1;fontColor=#ffffff;" value="4. git push" vertex="1">
          <mxGeometry height="30" width="180" x="60" y="245" as="geometry" />
        </mxCell>
        <mxCell id="push-arrow" edge="1" parent="1" source="dev-push" style="edgeStyle=orthogonalEdgeStyle;rounded=0;strokeColor=#6c8ebf;strokeWidth=3;fontStyle=1;fontSize=11;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="github-bg" value="git push">
          <mxGeometry relative="1" y="-10" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="github-bg" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#1A202C;strokeWidth=2;arcSize=11;" value="" vertex="1">
          <mxGeometry height="240" width="240" x="320" y="80" as="geometry" />
        </mxCell>
        <mxCell id="github-title" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontStyle=1;fontSize=13;" value="ðŸ™ GitHub Repository&#xa;(main branch)" vertex="1">
          <mxGeometry height="35" width="240" x="320" y="88" as="geometry" />
        </mxCell>
        <mxCell id="github-workflow" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;fontStyle=1;" value="ðŸ“ .github/workflows/deploy.yml&#xa;(pipeline definition)" vertex="1">
          <mxGeometry height="40" width="200" x="340" y="133" as="geometry" />
        </mxCell>
        <mxCell id="github-app" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#aaaaaa;fontSize=11;" value="ðŸ“ app/ (Dockerfile, html, nginx)" vertex="1">
          <mxGeometry height="30" width="200" x="340" y="183" as="geometry" />
        </mxCell>
        <mxCell id="github-ansible" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#aaaaaa;fontSize=11;" value="ðŸ“ Ansible/ (deploy.yml, roles)" vertex="1">
          <mxGeometry height="30" width="200" x="340" y="223" as="geometry" />
        </mxCell>
        <mxCell id="github-secrets" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=10;" value="ðŸ”’ Secrets: VM_HOST, VM_USERNAME&#xa;VM_SSH_KEY" vertex="1">
          <mxGeometry height="35" width="200" x="340" y="263" as="geometry" />
        </mxCell>
        <mxCell id="trigger-arrow" edge="1" parent="1" source="github-bg" style="edgeStyle=orthogonalEdgeStyle;rounded=0;strokeColor=#d6b656;strokeWidth=3;fontStyle=1;fontSize=11;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" target="runner-bg" value="Detects push to main&#xa;Triggers pipeline">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="runner-bg" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;strokeWidth=2;arcSize=7;" value="" vertex="1">
          <mxGeometry height="360" width="400" x="240" y="380" as="geometry" />
        </mxCell>
        <mxCell id="runner-title" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontStyle=1;fontSize=13;" value="âš™ï¸ GitHub Actions Runner&lt;br&gt;(Free Ubuntu machine - fresh every run)" vertex="1">
          <mxGeometry height="38" width="400" x="240" y="388" as="geometry" />
        </mxCell>
        <mxCell id="r-step1" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#9673a6;fontSize=11;" value="1. Checkout repository&lt;br&gt;(gets app/ and Ansible/ files)" vertex="1">
          <mxGeometry height="35" width="360" x="260" y="435" as="geometry" />
        </mxCell>
        <mxCell id="r-step2" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#9673a6;fontSize=11;" value="2. Install Ansible&lt;br&gt;(apt-get install ansible)" vertex="1">
          <mxGeometry height="35" width="360" x="260" y="478" as="geometry" />
        </mxCell>
        <mxCell id="r-step3" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=11;" value="3. Write SSH key to ~/.ssh/id_rsa&lt;br&gt;(from VM_SSH_KEY secret)" vertex="1">
          <mxGeometry height="35" width="360" x="260" y="521" as="geometry" />
        </mxCell>
        <mxCell id="r-step4" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#9673a6;fontSize=11;" value="4. ssh-keyscan â†’ known_hosts&lt;br&gt;(trust VM fingerprint, no manual confirm)" vertex="1">
          <mxGeometry height="35" width="360" x="260" y="564" as="geometry" />
        </mxCell>
        <mxCell id="r-step5" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#9673a6;fontSize=11;" value="5. Generate Ansible/inventory/hosts.ini&lt;br&gt;(VM_HOST and VM_USERNAME from secrets)" vertex="1">
          <mxGeometry height="35" width="360" x="260" y="607" as="geometry" />
        </mxCell>
        <mxCell id="r-step6" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;fontStyle=1;" value="6. ansible-playbook Ansible/deploy.yml&lt;br&gt;(runs all deployment tasks on the VM)" vertex="1">
          <mxGeometry height="35" width="360" x="260" y="650" as="geometry" />
        </mxCell>
        <mxCell id="r-step7" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;" value="7. Print live URL âœ…" vertex="1">
          <mxGeometry height="25" width="360" x="260" y="693" as="geometry" />
        </mxCell>
        <mxCell id="ssh-arrow" edge="1" parent="1" source="r-step6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;strokeColor=#82b366;strokeWidth=3;fontStyle=1;fontSize=11;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" target="vm-bg" value="SSH (Port 22)&#xa;ansible-playbook">
          <mxGeometry relative="1" x="-0.5596" y="-30" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="vm-bg" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;strokeWidth=2;arcSize=10;" value="" vertex="1">
          <mxGeometry height="430" width="280" x="720" y="155" as="geometry" />
        </mxCell>
        <mxCell id="vm-title" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontStyle=1;fontSize=13;" value="â˜ï¸ Azure VM&amp;nbsp;&lt;div&gt;Norway East | Ubuntu 24.04&lt;/div&gt;" vertex="1">
          <mxGeometry height="38" width="280" x="720" y="163" as="geometry" />
        </mxCell>
        <mxCell id="vm1" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;fontSize=11;" value="1. Create /opt/app directory" vertex="1">
          <mxGeometry height="28" width="244" x="738" y="210" as="geometry" />
        </mxCell>
        <mxCell id="vm2" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;fontSize=11;" value="2. Copy app/ files from runner" vertex="1">
          <mxGeometry height="28" width="244" x="738" y="246" as="geometry" />
        </mxCell>
        <mxCell id="vm3" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;fontSize=11;" value="3. Tear down old containers + images" vertex="1">
          <mxGeometry height="28" width="244" x="738" y="282" as="geometry" />
        </mxCell>
        <mxCell id="vm4" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=11;fontStyle=1;" value="4. docker-compose build (fresh image)" vertex="1">
          <mxGeometry height="28" width="244" x="738" y="318" as="geometry" />
        </mxCell>
        <mxCell id="vm5" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=11;fontStyle=1;" value="5. docker-compose up (start container)" vertex="1">
          <mxGeometry height="28" width="244" x="738" y="354" as="geometry" />
        </mxCell>
        <mxCell id="vm6" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;fontSize=11;" value="6. Wait 5 seconds" vertex="1">
          <mxGeometry height="28" width="244" x="738" y="390" as="geometry" />
        </mxCell>
        <mxCell id="vm7" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#82b366;fontSize=11;" value="7. Verify container state = running" vertex="1">
          <mxGeometry height="28" width="244" x="738" y="426" as="geometry" />
        </mxCell>
        <mxCell id="vm8" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;fontStyle=1;" value="8. Test localhost:8080 returns 200 âœ…" vertex="1">
          <mxGeometry height="28" width="244" x="738" y="462" as="geometry" />
        </mxCell>
        <mxCell id="container-box" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1f3ff;strokeColor=#0078d4;fontSize=11;fontStyle=1;" value="ðŸ³ Docker Container (webapp)&#xa;Nginx serving index.html&#xa;Port 8080 â†’ 80 | restart: always" vertex="1">
          <mxGeometry height="55" width="244" x="738" y="503" as="geometry" />
        </mxCell>
        <mxCell id="legend-bg" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;arcSize=11;" value="" vertex="1">
          <mxGeometry height="180" width="170" x="40" y="380" as="geometry" />
        </mxCell>
        <mxCell id="legend-title" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=center;fontStyle=1;fontSize=12;" value="Legend" vertex="1">
          <mxGeometry height="25" width="180" x="40" y="385" as="geometry" />
        </mxCell>
        <mxCell id="l1b" parent="1" style="rounded=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" value="" vertex="1">
          <mxGeometry height="16" width="16" x="55" y="415" as="geometry" />
        </mxCell>
        <mxCell id="l1t" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=left;fontSize=10;" value="Developer / local" vertex="1">
          <mxGeometry height="16" width="130" x="78" y="415" as="geometry" />
        </mxCell>
        <mxCell id="l2b" parent="1" style="rounded=1;fillColor=#e1d5e7;strokeColor=#9673a6;" value="" vertex="1">
          <mxGeometry height="16" width="16" x="55" y="438" as="geometry" />
        </mxCell>
        <mxCell id="l2t" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=left;fontSize=10;" value="GitHub Actions runner" vertex="1">
          <mxGeometry height="16" width="130" x="78" y="438" as="geometry" />
        </mxCell>
        <mxCell id="l3b" parent="1" style="rounded=1;fillColor=#f8cecc;strokeColor=#b85450;" value="" vertex="1">
          <mxGeometry height="16" width="16" x="55" y="461" as="geometry" />
        </mxCell>
        <mxCell id="l3t" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=left;fontSize=10;" value="SSH / secrets handling" vertex="1">
          <mxGeometry height="16" width="130" x="78" y="461" as="geometry" />
        </mxCell>
        <mxCell id="l4b" parent="1" style="rounded=1;fillColor=#d5e8d4;strokeColor=#82b366;" value="" vertex="1">
          <mxGeometry height="16" width="16" x="55" y="484" as="geometry" />
        </mxCell>
        <mxCell id="l4t" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=left;fontSize=10;" value="Azure VM / Ansible tasks" vertex="1">
          <mxGeometry height="16" width="130" x="78" y="484" as="geometry" />
        </mxCell>
        <mxCell id="l5b" parent="1" style="rounded=1;fillColor=#ffe6cc;strokeColor=#d79b00;" value="" vertex="1">
          <mxGeometry height="16" width="16" x="55" y="507" as="geometry" />
        </mxCell>
        <mxCell id="l5t" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=left;fontSize=10;" value="Docker build and run" vertex="1">
          <mxGeometry height="16" width="130" x="78" y="507" as="geometry" />
        </mxCell>
        <mxCell id="l6b" parent="1" style="rounded=1;fillColor=#e1f3ff;strokeColor=#0078d4;" value="" vertex="1">
          <mxGeometry height="16" width="16" x="55" y="530" as="geometry" />
        </mxCell>
        <mxCell id="l6t" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=left;fontSize=10;" value="Running container" vertex="1">
          <mxGeometry height="16" width="130" x="78" y="530" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
